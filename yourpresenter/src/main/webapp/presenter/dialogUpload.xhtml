<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j">

	<!-- <rich:notify id="notifyImportStarted" stack="notifyStack"
		summary="Import started"
		stayTime="#{preferencesView.viewNotifyStayTime}" sticky="#{preferencesView.viewNotifySticky}"
		nonblocking="#{preferencesView.viewNotifyNonblocking}"
		nonblockingOpacity="#{preferencesView.viewNotifyNonblockingOpacity}"
		showShadow="#{preferencesView.viewNotifyShowShadow}"
		showCloseButton="#{preferencesView.viewNotifyShowCloseButton}">
	</rich:notify>
	
	<rich:notify id="notifyImportDone" stack="notifyStack"
		summary="Import done"
		stayTime="#{preferencesView.viewNotifyStayTime}" sticky="#{preferencesView.viewNotifySticky}"
		nonblocking="#{preferencesView.viewNotifyNonblocking}"
		nonblockingOpacity="#{preferencesView.viewNotifyNonblockingOpacity}"
		showShadow="#{preferencesView.viewNotifyShowShadow}"
		showCloseButton="#{preferencesView.viewNotifyShowCloseButton}">
	</rich:notify> -->


	<a4j:jsFunction name="discartUpload" action="#{uploadView.discart}"
		oncomplete="#{rich:component('dialogUpload')}.hide();">
	</a4j:jsFunction>

	<!-- domElementAttachment is a must, otherwise rich:fileUpload doesn't work in rich:popupPanel,
		see: https://community.jboss.org/thread/172441 -->
	<rich:popupPanel id="dialogUpload" modal="true" autosized="true"
		resizeable="false" onmaskclick="discartUpload();"
		domElementAttachment="form">

		<h:form id="dialogUploadForm">
			<a4j:outputPanel id="dialogUploadPanel">
				<h:panelGroup>
					<rich:fileUpload fileUploadListener="#{uploadView.upload}"
						id="upload" acceptedTypes="#{uploadView.acceptedTypes}"
						ontyperejected="alert('Only file types: #{uploadView.acceptedTypes} are accepted');">
						<a4j:ajax event="uploadcomplete" execute="@none"
							render="buttonImport" />
							
						<!--  TODO issue: http://code.google.com/p/yourpresenter/issues/detail?id=2 -->
						<!-- <a4j:ajax event="clear" listener="#{uploadView.clear}" /> -->
					</rich:fileUpload>

					<a4j:commandButton id="buttonImport" value="Start Import"
						style="float:right" render="importProgress"
						disabled="#{uploadView.filesSize==0}"
						action="#{uploadView.startImport}"
						onclick="#{rich:component('dialogUpload')}.hide(); return true" />

				</h:panelGroup>
			</a4j:outputPanel>
		</h:form>
	</rich:popupPanel>

</ui:composition>